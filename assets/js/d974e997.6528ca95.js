"use strict";(self.webpackChunkpush_website=self.webpackChunkpush_website||[]).push([[76530],{60941:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return d},default:function(){return f},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var i=n(87462),o=n(63366),a=(n(67294),n(3905)),s=n(22004),r=["components"],l={id:"docs-notifications-develop-integrating-notifications",title:"Integrating Notifications",hide_title:!0,slug:"./integrating-notifications",displayed_sidebar:"pushNotificationSidebar",sidebar_position:16,image:"/assets/docs/previews/docs_notifications_develop--integrating_notifications.png"},d="Integrating notifications overview",p={unversionedId:"notifications/build/docs-notifications-develop-integrating-notifications",id:"notifications/build/docs-notifications-develop-integrating-notifications",title:"Integrating Notifications",description:"This section explores how to integrate notifications on your dApp, mobile app, crypto wallet or on any other frontend.",source:"@site/docs/notifications/01-build/16-Develop-Receiving-Notification.mdx",sourceDirName:"notifications/01-build",slug:"/notifications/build/integrating-notifications",permalink:"/docs/notifications/build/integrating-notifications",draft:!1,editUrl:"https://github.com/ethereum-push-notification-service/push-website/blob/main/docs/notifications/01-build/16-Develop-Receiving-Notification.mdx",tags:[],version:"current",sidebarPosition:16,frontMatter:{id:"docs-notifications-develop-integrating-notifications",title:"Integrating Notifications",hide_title:!0,slug:"./integrating-notifications",displayed_sidebar:"pushNotificationSidebar",sidebar_position:16,image:"/assets/docs/previews/docs_notifications_develop--integrating_notifications.png"},sidebar:"pushNotificationSidebar",previous:{title:"Stream Notifications",permalink:"/docs/notifications/build/stream-notifications"},next:{title:"Tutorials",permalink:"/docs/notifications/tutorials"}},c={},u=[{value:"Integration process",id:"integration-process",level:2},{value:"Receiving notifications",id:"receiving-notifications",level:2},{value:"Pull based method",id:"pull-based-method",level:3},{value:"Push based method",id:"push-based-method",level:3},{value:"Bridge based method",id:"bridge-based-method",level:3},{value:"Pull method live implementation",id:"pull-method-live-implementation",level:2},{value:"Push method live implementation",id:"push-method-live-implementation",level:2},{value:"Bridge method implementation - Push delivery node",id:"bridge-method-implementation---push-delivery-node",level:2},{value:"Step 1\ufe0f\u20e3 - Prerequisites",id:"step-1\ufe0f\u20e3---prerequisites",level:3},{value:"Step 2\ufe0f\u20e3 - Clone Push delivery node repo",id:"step-2\ufe0f\u20e3---clone-push-delivery-node-repo",level:3},{value:"Step 3\ufe0f\u20e3 - Environment configuration",id:"step-3\ufe0f\u20e3---environment-configuration",level:3},{value:"Step 4\ufe0f\u20e3 - Infra Setup: Local",id:"step-4\ufe0f\u20e3---infra-setup-local",level:3},{value:"Step 5\ufe0f\u20e3 - (Optional) Infra Setup: Server (Production)",id:"step-5\ufe0f\u20e3---optional-infra-setup-server-production",level:3},{value:"Step 6\ufe0f\u20e3 - FCM Project Setup",id:"step-6\ufe0f\u20e3---fcm-project-setup",level:3},{value:"Step 7\ufe0f\u20e3 - Build the delivery node project",id:"step-7\ufe0f\u20e3---build-the-delivery-node-project",level:3},{value:"Step 8\ufe0f\u20e3 - Start the delivery node project",id:"step-8\ufe0f\u20e3---start-the-delivery-node-project",level:3},{value:"Step 9\ufe0f\u20e3 - Device Registration",id:"step-9\ufe0f\u20e3---device-registration",level:3}],h={toc:u},m="wrapper";function f(e){var t=e.components,n=(0,o.Z)(e,r);return(0,a.kt)(m,(0,i.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"integrating-notifications-overview"},"Integrating notifications overview"),(0,a.kt)("p",null,"This section explores how to integrate notifications on your dApp, mobile app, crypto wallet or on any other frontend."),(0,a.kt)("p",null,"Push is an interoperable network which already have live integrations from ",(0,a.kt)("a",{parentName:"p",href:"https://snaps.metamask.io/snap/npm/pushprotocol/snap/",title:"Push Metamask snap"},"Push Metamask snap"),", ",(0,a.kt)("a",{parentName:"p",href:"https://unstoppabledomains.com/",title:"Unstoppable integration with Push"},"Unstoppable web / mobile app"),", ",(0,a.kt)("a",{parentName:"p",href:"https://app.push.org/channels#receive-notifications",title:"Push dApp"},"Push dapp / mobile app / extension")," among other dapps, extensions and mobile apps. This means notifs are already received by wallets that are on those platforms as they have integrated Push protocol. "),(0,a.kt)("head",null,(0,a.kt)("title",null,"Integrate Notifications | Push Notifications | Push Documentation")),(0,a.kt)("h2",{id:"integration-process"},"Integration process"),(0,a.kt)("p",null,"Integrating notifications directly on your frontend is a critical component as it enables your users to have the best experience and massively improves re-engagement and Web3 UX for your protocol. "),(0,a.kt)("p",null,"To get started, you will need to \u2014"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Ensure your frontend has a way for your users ",(0,a.kt)("a",{parentName:"li",href:"/docs/notifications/build/manage-subscriptions/#subscribe-channel-api",title:"Subscribe (opt-in) API for Push protocol notifications"},"to opt in to your channel")," on your frontend."),(0,a.kt)("li",{parentName:"ul"},"Choose what notification fetching mechanism you want to integrate for notifications to your users (",(0,a.kt)("strong",{parentName:"li"},"Pull based"),", ",(0,a.kt)("strong",{parentName:"li"},"Push based")," or ",(0,a.kt)("strong",{parentName:"li"},"bridge based"),") on your frontend.")),(0,a.kt)("h2",{id:"receiving-notifications"},"Receiving notifications"),(0,a.kt)("p",null,"Notifications can be received on your frontend using either active user interaction, also known as ",(0,a.kt)("strong",{parentName:"p"},"pull based method")," or showing notifications as soon as it's triggered requiring no user interaction, which is known as ",(0,a.kt)("strong",{parentName:"p"},"push based method")," or triggering additional logic when notification is sent to a user using ",(0,a.kt)("strong",{parentName:"p"},"bridge based method"),"."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You will need to pick the best method according to your needs. Most of the time, it will be a combination of ",(0,a.kt)("strong",{parentName:"p"},"Pull")," and ",(0,a.kt)("strong",{parentName:"p"},"Push")," or all three for a more polished and re-engaging experience for your user.")),(0,a.kt)("h3",{id:"pull-based-method"},"Pull based method"),(0,a.kt)("p",null,"This method enables users to see notifications when they actively interact with an object on your frontend and relies on fetching notifications using restful APIs. For example: when you click ",(0,a.kt)("strong",{parentName:"p"},"bell icon")," on youtube and it fetches your notifications."),(0,a.kt)("h3",{id:"push-based-method"},"Push based method"),(0,a.kt)("p",null,"This method doesn't rely on user interaction, instead it shows users notifications as soon as the frontend receives it. This is useful particularly when a user is on your frontend and you show them notifications as they are received."),(0,a.kt)("h3",{id:"bridge-based-method"},"Bridge based method"),(0,a.kt)("p",null,"This method is usually used when you want notifications to land on user's mobile home screen or through browser notification service. "),(0,a.kt)("p",null,"Bridge based method allows triggering additional logic and are more of an extension to ",(0,a.kt)("strong",{parentName:"p"},"push based method")," as they enable routing to other Web2 notification services such as ",(0,a.kt)("a",{parentName:"p",href:"https://firebase.google.com/",title:"Link to google firebase"},"Firebase"),", ",(0,a.kt)("a",{parentName:"p",href:"https://developer.apple.com/documentation/usernotifications",title:"Link to APNS (Apple Push Notificaiton Service)"},"Apple Push Notification Service")," or to telegram / twitter / or other social bots."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Bridge based delivery is especially useful if you want to deliver notifications to your mobile app or extension while pull based and push based mechanism works best inside your dapp or mobile app.")),(0,a.kt)("h2",{id:"pull-method-live-implementation"},"Pull method live implementation"),(0,a.kt)("p",null,"Implementing pull based mechanism requires inclusion of ",(0,a.kt)("a",{parentName:"p",href:"/docs/notifications/build/fetch-notifications/",title:"API for fetching notificatons from Push protocol"},"fetch notifications API")," and then using your custom frontend component or UIWeb component of Push to display them."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live",live:!0},"customPropMinimized=\"true\"\n\n// DO NOT FORGET TO IMPORT LIBRARIES\n// NOT NEEDED HERE SINCE PLAYGROUND IMPORTS INTERNALLY\n\n// import { ethers } from ethers;\n// import { PushAPI } from @pushprotocol/restapi;\n// import { NotificationItem } from @pushprotocol/uiweb;\n\nfunction App(props) {\n  const [wallet, setWallet] = useState('0xB59Cdc85Cacd15097ecE4C77ed9D225014b4D56D');\n  const [notifItems, setNotifItems] = useState([]);\n\n  const walletRef = useRef();\n\n  useEffect(() => {\n    if (walletRef.current) {\n      walletRef.current.value = wallet;\n    }\n  }, [wallet]);\n\n  const fetchNotification = async () => {\n    const walletText = walletRef.current.value;\n\n    // Demo only supports MetaMask (or other browser based wallets) and gets provider that injects as window.ethereum into each page\n    const provider = new ethers.providers.Web3Provider(window.ethereum);\n\n    // Get provider\n    await provider.send(\"eth_requestAccounts\", []);\n\n    // Grabbing signer from provider\n    const signer = provider.getSigner()\n\n    // Initialize user for push\n    const userAlice = await PushAPI.initialize(signer, { env: 'staging' })\n\n    // retrieve notifications for users\n    const inboxNotifications = await userAlice.notification.list('INBOX', {limit: 5})\n\n    // set notifItems state so that react can render\n    setNotifItems(inboxNotifications);\n  };\n\n  function NotificationInterface() {\n    const inputStyle = {\n      padding: '10px',\n      margin: '10px 0',\n      width: '100%',\n      boxSizing: 'border-box',\n    };\n\n    const textareaStyle = {\n      ...inputStyle,\n      height: '100px',\n      resize: 'vertical',\n    };\n\n    const buttonStyle = {\n      padding: '10px 20px',\n      backgroundColor: '#dd44b9',\n      color: '#FFF',\n      border: 'none',\n      borderRadius: '5px',\n      cursor: 'pointer',\n      marginTop: '20px',\n    };\n\n    return (\n      <div style={{ width: 'auto', margin: '20px auto' }}>\n        <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n          <div style={{ flex: 1 }}>\n            <h2>Pull based mechanism for displaying notifcations on frontend</h2>\n            <p />\n            <label>Put any wallet address and click on fetch notifications to see the live results. Click to expand <b>Live Editor</b> tab to see the code and play with it. For this demo, You will need Metamask (or equivalent browser injected wallet), you will also need to sign a transaction to see the notifications.</label>\n            <p />\n            <label>Wallet address</label>\n            <input \n              type=\"text\" \n              placeholder=\"Enter wallet address\" \n              style={inputStyle}\n              ref={walletRef}\n              maxLength={80}\n            />\n          </div>\n        </div>\n        <button style={buttonStyle} onClick={fetchNotification}>Fetch Notifications</button>\n\n        <p /> \n        <p />\n\n        {notifItems.length > 0 ? <h3>{`Notification Items for ${wallet}`}</h3> : <></>\n        }\n        \n        {notifItems.map((notifItemSingular, idx) => {\n          const { \n            cta,\n            title,\n            message,\n            app,\n            icon,\n            image,\n            url,\n            blockchain,\n            notification\n          } = notifItemSingular;\n\n          return (\n            <NotificationItem\n              key={idx} // any unique id\n              notificationTitle={title}\n              notificationBody={message}\n              cta={cta}\n              app={app}\n              icon={icon}\n              image={image}\n              url={url}\n              theme={'light'} // or can be dark\n              chainName={blockchain}\n              // chainName={blockchain as chainNameType} // if using Typescript\n            />\n            );\n          })}\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <NotificationInterface />\n    </>\n  );\n}\n")),(0,a.kt)("h2",{id:"push-method-live-implementation"},"Push method live implementation"),(0,a.kt)("p",null,"Implementing push based mechanism requires connecting to Push nodes via ",(0,a.kt)("a",{parentName:"p",href:"/docs/notifications/build/stream-notifications/",title:"API for streaming notificatons from Push protocol"},"stream notifications API")," which will trigger notifications as they come. You can then use your custom frontend component or UIWeb component of Push to display them."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live",live:!0},"customPropMinimized=\"true\"\n\n// DO NOT FORGET TO IMPORT LIBRARIES\n// NOT NEEDED HERE SINCE PLAYGROUND IMPORTS INTERNALLY\n\n// import { ethers } from ethers;\n// import { PushAPI } from @pushprotocol/restapi;\n// import { NotificationItem } from @pushprotocol/uiweb;\n\nfunction App(props) {\n  const [wallet, setWallet] = useState('0xB59Cdc85Cacd15097ecE4C77ed9D225014b4D56D');\n  const [notifItems, setNotifItems] = useState([]);\n\n  const walletRef = useRef();\n\n  useEffect(() => {\n    if (walletRef.current) {\n      walletRef.current.value = wallet;\n    }\n  }, [wallet]);\n\n  const triggerNotification = async () => {\n    const walletText = walletRef.current.value;\n\n    // Demo only supports MetaMask (or other browser based wallets) and gets provider that injects as window.ethereum into each page\n    const provider = new ethers.providers.Web3Provider(window.ethereum);\n\n    // Get provider\n    await provider.send(\"eth_requestAccounts\", []);\n\n    // Grabbing signer from provider\n    const signer = provider.getSigner()\n\n    // Initialize user for push\n    const userAlice = await PushAPI.initialize(signer, { env: 'staging' })\n\n    // establish connection to stream\n    const stream = userAlice.stream({ \n      listen: [STREAM.NOTIF], \n    })\n\n    // Listen for notifications\n    userAlice.stream.on(STREAM.NOTIF, (data) => {\n      console.log(data)\n    });\n  };\n\n  function NotificationInterface() {\n    const inputStyle = {\n      padding: '10px',\n      margin: '10px 0',\n      width: '100%',\n      boxSizing: 'border-box',\n    };\n\n    const textareaStyle = {\n      ...inputStyle,\n      height: '100px',\n      resize: 'vertical',\n    };\n\n    const buttonStyle = {\n      padding: '10px 20px',\n      backgroundColor: '#dd44b9',\n      color: '#FFF',\n      border: 'none',\n      borderRadius: '5px',\n      cursor: 'pointer',\n      marginTop: '20px',\n    };\n\n    return (\n      <div style={{ width: 'auto', margin: '20px auto' }}>\n        <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n          <div style={{ flex: 1 }}>\n            <h2>Push based mechanism for displaying notifcations on frontend</h2>\n            <p />\n            <label>Put any wallet address and click on fetch notifications to see the live results. Click to expand <b>Live Editor</b> tab to see the code and play with it. For this demo, You will need Metamask (or equivalent browser injected wallet), you will also need to sign a transaction to see the notifications.</label>\n            <p />\n            <label>Wallet address</label>\n            <input \n              type=\"text\" \n              placeholder=\"Enter wallet address\" \n              style={inputStyle}\n              ref={walletRef}\n              maxLength={80}\n            />\n          </div>\n        </div>\n        <button style={buttonStyle} onClick={triggerNotification}>Trigger Notification</button>\n\n        <p /> \n        <p />\n\n        {notifItems.length > 0 ? <h3>{`Notification Items for ${wallet}`}</h3> : <></>\n        }\n        \n        {notifItems.map((notifItemSingular, idx) => {\n          const { \n            cta,\n            title,\n            message,\n            app,\n            icon,\n            image,\n            url,\n            blockchain,\n            notification\n          } = notifItemSingular;\n\n          return (\n            <NotificationItem\n              key={idx} // any unique id\n              notificationTitle={title}\n              notificationBody={message}\n              cta={cta}\n              app={app}\n              icon={icon}\n              image={image}\n              url={url}\n              theme={'light'} // or can be dark\n              chainName={blockchain}\n              // chainName={blockchain as chainNameType} // if using Typescript\n            />\n            );\n          })}\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <NotificationInterface />\n    </>\n  );\n}\n")),(0,a.kt)("h2",{id:"bridge-method-implementation---push-delivery-node"},"Bridge method implementation - Push delivery node"),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Delivery node is the recomended way to setup your mobile home screen push notifications or to connect to Push protocol notification network via your OS!!")),(0,a.kt)("p",null,"Push delivery Nodes is a Whitelabel solution to enable any app, either mobile, desktop, or extension, to allow Web3 push notifications to their app. "),(0,a.kt)("p",null,"It is a decentralized solutions to enable web3 to web2 bridging. It allows any platform (whether centralized or decentralized) to receive communication from ",(0,a.kt)("strong",{parentName:"p"},"Push storage nodes"),", i.e., the nodes validating and indexing all communications and tying them to your wallet address (and multi-chain identity). "),(0,a.kt)(s.Z,{controls:!0,width:"100%",url:"https://www.youtube.com/watch?v=OlRHL3qd4oY",mdxType:"ReactPlayer"}),(0,a.kt)("br",null),(0,a.kt)("p",null,"The whitelabel solution of Push delivery node ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/ethereum-push-notification-service/push-delivery-node",title:"Repo of delivery node of Push protocol"},"is located in this github repo"),". Below are the steps for getting started \u2014"),(0,a.kt)("h3",{id:"step-1\ufe0f\u20e3---prerequisites"},"Step 1\ufe0f\u20e3 - Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MYSQL (Version >= 5.7)")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Redis (Version >= 6.0)")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Docker (For local setup)")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Google FCM Account Setup"))),(0,a.kt)("h3",{id:"step-2\ufe0f\u20e3---clone-push-delivery-node-repo"},"Step 2\ufe0f\u20e3 - Clone Push delivery node repo"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/ethereum-push-notification-service/push-delivery-node.git\n")),(0,a.kt)("h3",{id:"step-3\ufe0f\u20e3---environment-configuration"},"Step 3\ufe0f\u20e3 - Environment configuration"),(0,a.kt)("p",null,"Refer env sample file. The MYSQL DB credentials and Redis URL needs to be updated. The remaining conf need not be edited as of now."),(0,a.kt)("p",null,"If you use docker-compose for the local setup MYSQL DB and Redis config can be left as it is."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"# REDIS\n\nREDIS_URL=redis://localhost:6379\n\n# DELIVERY NODE MYSQL DATABASE\n\nDELIVERY_NODE_DB_HOST=localhost\nDELIVERY_NODE_DB_NAME=dbname\nDELIVERY_NODE_DB_USER=user\nDELIVERY_NODE_DB_PASS=pass\nDELIVERY_NODE_DB_PORT=3306\n")),(0,a.kt)("h3",{id:"step-4\ufe0f\u20e3---infra-setup-local"},"Step 4\ufe0f\u20e3 - Infra Setup: Local"),(0,a.kt)("p",null,"The docker-compose will bring up the MYSQL, Redis, and PHPMyAdmin containers for the delivery node."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose up\n")),(0,a.kt)("h3",{id:"step-5\ufe0f\u20e3---optional-infra-setup-server-production"},"Step 5\ufe0f\u20e3 - (Optional) Infra Setup: Server (Production)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Host MYSQL and Redis Separately"),(0,a.kt)("li",{parentName:"ul"},"Add MYSQL and Redis credentials in the .env file")),(0,a.kt)("h3",{id:"step-6\ufe0f\u20e3---fcm-project-setup"},"Step 6\ufe0f\u20e3 - FCM Project Setup"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Refer ",(0,a.kt)("a",{parentName:"li",href:"https://firebase.google.com/docs/admin/setup",title:"Article from google on how to setup Firebase"},"Firebase docs")," to setup FCM"),(0,a.kt)("li",{parentName:"ul"},"Create the firebase-adminsdk.json file in the root folder and add the FCM JSON to this file")),(0,a.kt)("h3",{id:"step-7\ufe0f\u20e3---build-the-delivery-node-project"},"Step 7\ufe0f\u20e3 - Build the delivery node project"),(0,a.kt)("p",null,"You should then be able to build the project using"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cd push-delivery-node\nnpm install\n")),(0,a.kt)("h3",{id:"step-8\ufe0f\u20e3---start-the-delivery-node-project"},"Step 8\ufe0f\u20e3 - Start the delivery node project"),(0,a.kt)("p",null,"You should then be able to start the server using the following"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cd push-delivery-node\nnpm start\n")),(0,a.kt)("h3",{id:"step-9\ufe0f\u20e3---device-registration"},"Step 9\ufe0f\u20e3 - Device Registration"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"An endpoint is hosted as part of the delivery node project, which can be used for Device Registration."),(0,a.kt)("li",{parentName:"ul"},"Below is the API to create a mapping between the wallet address and the device token for which the messages need to be delivered."),(0,a.kt)("li",{parentName:"ul"},"<delivery_node_url> is the base URL of the delivery node you have hosted.")),(0,a.kt)("p",null,"Below is the curl request of this endpoint"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'\ncurl --location --request POST \'https://<delivery_node_url>/apis/v1/pushtokens/register\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    \n    "wallet": "eip155:0x35B84d6848D16415177c64D64504663b998A6ab4",\n    "device_token": "device_token",\n    "platform": "android"\n}\'\n')))}f.isMDXComponent=!0}}]);